config {
    type: "table",
    tags: "IE"
}

select distinct userId as parentid,IEId as childid,Cohort,safe_cast(concat("91",UserLogin) as int64)ParentMobileMain,u.projectId,reportingUserloginname As agentMobile, reportingUserDisplayName as agentName
from `impact_evaluation.IE_pilot` -- change to main table once we main experiment starts

inner join ${ref("User")} u
on safe_cast(concat("91",UserLogin) as int64) = phoneNo

Inner join  ${ref("IE")}
on OnBoardedUserId = userid
where `group` = "Treatment"
